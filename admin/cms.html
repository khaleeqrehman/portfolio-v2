<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CMS</title>
  <!-- Load CSS separately -->
  <link rel="stylesheet" href="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.css">
</head>
<body>
  <!-- Isolated mount point with explicit ID -->
  <div id="cms-root" style="position: relative; z-index: 1;"></div>

  <!-- Load JS with defer -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js" defer></script>

  <!-- Safe initialization with error handling -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      function initCMS() {
        const root = document.getElementById('cms-root');
        if (!root) {
          console.error('CMS mount point not found');
          return;
        }

        if (window.CMS) {
          try {
            CMS.init({
              config: {
                backend: {
                  name: "github",
                  repo: "khaleeqrehman/portfolio-v2",
                  branch: "main"
                },
                media_folder: "static/images/uploads",
                public_folder: "/images/uploads",
                collections: [ /* your collections */ ]
              }
            });
          } catch (e) {
            console.error('CMS init failed:', e);
          }
        } else {
          setTimeout(initCMS, 100);
        }
      }
      initCMS();
    });
  </script>
</body>
</html>