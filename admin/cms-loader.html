<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>CMS Loader</title>
  <style>
    body { margin: 0; overflow: hidden; }
    #cms-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      border: none;
    }
  </style>
</head>
<body>
  <!-- Empty container for CMS -->
  <div id="cms-container"></div>

  <!-- Load CMS assets directly -->
  <link rel="stylesheet" href="https://unpkg.com/decap-cms@3.8.3/dist/decap-cms.css">
  <script src="https://unpkg.com/decap-cms@3.8.3/dist/decap-cms.js"></script>

  <!-- Atomic Initialization -->
  <script>
    (function() {
      // Create fresh DOM environment
      const container = document.getElementById('cms-container');
      container.innerHTML = '<div id="cms-root"></div>';
      
      // Wait for everything to settle
      setTimeout(function() {
        try {
          CMS.init({
            config: {
              backend: {
                name: "github",
                repo: "khaleeqrehman/portfolio-v2",
                branch: "main"
              },
              media_folder: "static/images/uploads",
              public_folder: "/images/uploads",
              collections: [ /* your collections */ ]
            }
          });
        } catch (e) {
          console.error('CMS Init Error:', e);
          // Fallback to full page reload
          window.location.reload();
        }
      }, 300); // Artificial delay for stability
    })();
  </script>
</body>
</html>